<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../../.././style.css"></link><link rel="icon" href="../../.././favicon.svg"></link><link rel="mask-icon" href="../../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../../.././/declarations/declaration-data.bmp" as="image"></link><title>Mathlib.Tactic.Linter.Header</title><script defer="true" src="../../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../../.././";</script><script>const MODULE_NAME="Mathlib.Tactic.Linter.Header";</script><script type="module" src="../../.././jump-src.js"></script><script type="module" src="../../.././search.js"></script><script type="module" src="../../.././expand-nav.js"></script><script type="module" src="../../.././how-about.js"></script><script type="module" src="../../.././instances.js"></script><script type="module" src="../../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">Linter</span>.<span class="name">Header</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover-community/mathlib4/blob/15e31b9dbf80fe0a2fcdf0eef4630bd80409b5f1/Mathlib/Tactic/Linter/Header.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../../.././Init.html">Init</a></li><li><a href="../../.././Lean/Elab/Command.html">Lean.Elab.Command</a></li><li><a href="../../.././Lean/Elab/ParseImportsFast.html">Lean.Elab.ParseImportsFast</a></li><li><a href="../../.././Mathlib/Tactic/Linter/DirectoryDependency.html">Mathlib.Tactic.Linter.DirectoryDependency</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Mathlib.Tactic.Linter.Header" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Mathlib.Linter.firstNonImport?"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">firstNonImport?</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Linter.getImportIds"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">getImportIds</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Linter.parseUpToHere"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">parseUpToHere</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Linter.toSyntax"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">toSyntax</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Linter.authorsLineChecks"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">authorsLineChecks</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Linter.copyrightHeaderChecks"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">copyrightHeaderChecks</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Linter.isInMathlib"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">isInMathlib</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Linter.inMathlibRef"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">inMathlibRef</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Linter.linter.style.header"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">linter</span>.<span class="name">style</span>.<span class="name">header</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Linter.Style.header.broadImportsCheck"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">Style</span>.<span class="name">header</span>.<span class="name">broadImportsCheck</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Linter.Style.header.duplicateImportsCheck"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">Style</span>.<span class="name">header</span>.<span class="name">duplicateImportsCheck</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Linter.Style.header.headerLinter"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">Style</span>.<span class="name">header</span>.<span class="name">headerLinter</span></a></div></nav><main>
<div class="mod_doc"><h1 class="markdown-heading" id="The-header-linter">The &quot;header&quot; linter <a class="hover-link" href="#The-header-linter">#</a></h1><p>The &quot;header&quot; style linter checks that a file starts with</p><pre><code>/-
Copyright ...
Apache ...
Authors ...
-/

import statements*
module doc-string*
remaining file
</code></pre><p>It emits a warning if</p><ul>
<li>the copyright statement is malformed;</li>
<li><code>Mathlib.Tactic</code> is imported;</li>
<li>any import in <code>Lake</code> is present;</li>
<li>the first non-<code>import</code> command is not a module doc-string.</li>
</ul><p>The linter allows <code>import</code>-only files and does not require a copyright statement in <code>Mathlib.<a href="../../.././Init.html">Init</a></code>.</p><h2 class="markdown-heading" id="Implementation">Implementation <a class="hover-link" href="#Implementation">#</a></h2><p>The strategy used by the linter is as follows.
The linter computes the end position of the first module doc-string of the file,
resorting to the end of the file, if there is no module doc-string.
Next, the linter tries to parse the file up to the position determined above.</p><p>If the parsing is successful, the linter checks the resulting <code>Syntax</code> and behaves accordingly.</p><p>If the parsing is not successful, this already means there is some &quot;problematic&quot; command
after the imports. In particular, there is a command that is not a module doc-string
immediately following the last import: the file should be flagged by the linter.
Hence, the linter then falls back to parsing the header of the file, adding a spurious <code>section</code>
after it.
This makes it possible for the linter to check the entire header of the file, emit warnings that
could arise from this part and also flag that the file should contain a module doc-string after
the <code>import</code> statements.</p></div><div class="decl" id="Mathlib.Linter.firstNonImport?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/15e31b9dbf80fe0a2fcdf0eef4630bd80409b5f1/Mathlib/Tactic/Linter/Header.lean#L55-L66">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.firstNonImport?"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">firstNonImport?</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a> → <span class="fn"><a href="../../.././Init/Prelude.html#Option">Option</a> <a href="../../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a></span></span></div></div><p><code><a href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.firstNonImport?">firstNonImport?</a> stx</code> assumes that the input <code>Syntax</code> is of kind <code><a href="../../.././Lean/Parser/Module.html#Lean.Parser.Module.module">Lean.Parser.Module.module</a></code>.
It returns</p><ul>
<li><code>none</code>, if <code>stx</code> consists only of <code>import</code> statements,</li>
<li>the first non-<code>import</code> command in <code>stx</code>, otherwise.</li>
</ul><p>The intended use-case is to use the output of <code>testParseModule</code> as the input of
<code><a href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.firstNonImport?">firstNonImport?</a></code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.firstNonImport?">Mathlib.Linter.firstNonImport?</a> <span class="fn">x✝</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a>   <span class="fn">match <span class="fn">x✝</span> with
  | <span class="fn"><a href="../../.././Init/Prelude.html#Lean.Syntax.node">Lean.Syntax.node</a> <span class="fn">info</span> <span class="fn">`Lean.Parser.Module.module</span> <a href="../../.././Init/Prelude.html#List.toArray">#[</a><span class="fn">_header</span><a href="../../.././Init/Prelude.html#List.cons">,</a> <span class="fn"><a href="../../.././Init/Prelude.html#Lean.Syntax.node">Lean.Syntax.node</a> <span class="fn">info_1</span> <span class="fn">`null</span> <span class="fn">args</span></span><a href="../../.././Init/Prelude.html#List.toArray">]</a></span> =&gt; <span class="fn">args</span><a href="../../.././Init/GetElem.html#GetElem?.getElem?">[</a><span class="fn">0</span><a href="../../.././Init/GetElem.html#GetElem?.getElem?">]</a><a href="../../.././Init/GetElem.html#GetElem?.getElem?">?</a>
  | <span class="fn">x</span> =&gt; <span class="fn"><a href="../../.././Init/Prelude.html#Option.some">some</a> <a href="../../.././Init/Prelude.html#Lean.Syntax.missing">Lean.Syntax.missing</a></span></span></li></ul></details><details id="instances-for-list-Mathlib.Linter.firstNonImport?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Linter.getImportIds"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/15e31b9dbf80fe0a2fcdf0eef4630bd80409b5f1/Mathlib/Tactic/Linter/Header.lean#L68-L81">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.getImportIds"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">getImportIds</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <a href="../../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Prelude.html#Array">Array</a> <a href="../../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a></span></div></div><p><code><a href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.getImportIds">getImportIds</a> s</code> takes as input <code>s : Syntax</code>.
It returns the array of all <code>import</code> identifiers in <code>s</code>.</p></div></div><div class="decl" id="Mathlib.Linter.parseUpToHere"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/15e31b9dbf80fe0a2fcdf0eef4630bd80409b5f1/Mathlib/Tactic/Linter/Header.lean#L83-L102">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.parseUpToHere"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">parseUpToHere</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">pos</span> : <a href="../../.././Init/Prelude.html#String.Pos">String.Pos</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">post</span> : <a href="../../.././Init/Prelude.html#String">String</a> := <span class="fn">&quot;&quot;</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a></span></div></div><p><code><a href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.parseUpToHere">parseUpToHere</a> pos post</code> takes as input <code>pos : <a href="../../.././Init/Prelude.html#String.Pos">String.Pos</a></code> and the optional <code>post : <a href="../../.././Init/Prelude.html#String">String</a></code>.
It parses the current file from the beginning until <code>pos</code>, appending <code>post</code> at the end.
It returns a syntax node of kind <code><a href="../../.././Lean/Parser/Module.html#Lean.Parser.Module.module">Lean.Parser.Module.module</a></code>.
The option of appending a final string to the text gives more control to avoid syntax errors,
for instance in the presence of <code>#guard_msgs in</code> or <code>set_option ... in</code>.</p><p>Note that this parsing will <em>not</em> be successful on every file.  However, if the linter is
parsing the file linearly, it will only need to parse</p><ul>
<li>the imports (that are always parseable) and</li>
<li>the first non-import command that is supposed to be a module doc-string (so again always
parseable).</li>
</ul><p>In conclusion, either the parsing is successful, and the linter can continue with its analysis,
or the parsing is not successful and the linter will flag a missing module doc-string!</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Mathlib.Linter.parseUpToHere" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Linter.toSyntax"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/15e31b9dbf80fe0a2fcdf0eef4630bd80409b5f1/Mathlib/Tactic/Linter/Header.lean#L104-L110">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.toSyntax"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">toSyntax</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">s </span><span class="fn">pattern</span> : <a href="../../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">offset</span> : <a href="../../.././Init/Prelude.html#String.Pos">String.Pos</a> := <span class="fn">0</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a></div></div><p><code><a href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.toSyntax">toSyntax</a> s pattern</code> converts the two input strings into a <code>Syntax</code>, assuming that <code>pattern</code>
is a substring of <code>s</code>:
the syntax is an atom with value <code>pattern</code> whose the range is the range of <code>pattern</code> in <code>s</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Mathlib.Linter.toSyntax" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Linter.authorsLineChecks"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/15e31b9dbf80fe0a2fcdf0eef4630bd80409b5f1/Mathlib/Tactic/Linter/Header.lean#L112-L137">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.authorsLineChecks"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">authorsLineChecks</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">line</span> : <a href="../../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">offset</span> : <a href="../../.././Init/Prelude.html#String.Pos">String.Pos</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Prelude.html#Array">Array</a> (<a href="../../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a> <a href="../../.././Init/Prelude.html#Prod">×</a> <a href="../../.././Init/Prelude.html#String">String</a>)</span></div></div><p>Return if <code>line</code> looks like a correct authors line in a copyright header.</p><p>The <code>offset</code> input is used to shift the position information of the <code>Syntax</code> that the command
produces.
<code><a href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.authorsLineChecks">authorsLineChecks</a></code> computes a position for its warning <em>relative to <code>line</code></em>.
The <code>offset</code> input passes on the starting position of <code>line</code> in the whole file.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Mathlib.Linter.authorsLineChecks" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Linter.copyrightHeaderChecks"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/15e31b9dbf80fe0a2fcdf0eef4630bd80409b5f1/Mathlib/Tactic/Linter/Header.lean#L139-L208">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.copyrightHeaderChecks"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">copyrightHeaderChecks</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">copyright</span> : <a href="../../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Prelude.html#Array">Array</a> (<a href="../../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a> <a href="../../.././Init/Prelude.html#Prod">×</a> <a href="../../.././Init/Prelude.html#String">String</a>)</span></div></div><p>The main function to validate the copyright string.
The input is the copyright string, the output is an array of <code>Syntax × <a href="../../.././Init/Prelude.html#String">String</a></code> encoding:</p><ul>
<li>the <code>Syntax</code> factors are atoms whose ranges are &quot;best guesses&quot; for where the changes should
take place; the embedded string is the current text that the linter flagged;</li>
<li>the <code><a href="../../.././Init/Prelude.html#String">String</a></code> factor is the linter message.</li>
</ul><p>The linter checks that</p><ul>
<li>the first and last line of the copyright are a <code>(&quot;/-&quot;, &quot;-/&quot;)</code> pair, each on its own line;</li>
<li>the first line is begins with <code>Copyright (c) 20</code> and ends with <code>. All rights reserved.</code>;</li>
<li>the second line is <code>Released under Apache 2.0 license as described in the file LICENSE.</code>;</li>
<li>the remainder of the string begins with <code>Authors: </code>, does not end with <code>.</code> and
contains no <code>and</code> nor a double space, except possibly after a line break.</li>
</ul><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Mathlib.Linter.copyrightHeaderChecks" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Linter.isInMathlib"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/15e31b9dbf80fe0a2fcdf0eef4630bd80409b5f1/Mathlib/Tactic/Linter/Header.lean#L210-L220">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.isInMathlib"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">isInMathlib</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">modName</span> : <a href="../../.././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/System/IO.html#IO">IO</a> <a href="../../.././Init/Prelude.html#Bool">Bool</a></span></div></div><p><code><a href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.isInMathlib">isInMathlib</a> modName</code> returns <code>true</code> if <code>Mathlib.lean</code> imports the file <code>modName</code> and <code>false</code>
otherwise.
This is used by the <code>Header</code> linter as a heuristic of whether it should inspect the file or not.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Mathlib.Linter.isInMathlib" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Linter.inMathlibRef"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/15e31b9dbf80fe0a2fcdf0eef4630bd80409b5f1/Mathlib/Tactic/Linter/Header.lean#L222-L229">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.inMathlibRef"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">inMathlibRef</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/System/IO.html#IO.Ref">IO.Ref</a> <span class="fn">(<a href="../../.././Init/Prelude.html#Option">Option</a> <a href="../../.././Init/Prelude.html#Bool">Bool</a>)</span></span></div></div><p><code><a href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.inMathlibRef">inMathlibRef</a></code> is</p><ul>
<li><code>none</code> at initialization time;</li>
<li><code>some true</code> if the <code><a href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.linter.style.header">header</a></code> linter has already discovered that the current file
is imported in <code>Mathlib.lean</code>;</li>
<li><code>some false</code> if the <code><a href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.linter.style.header">header</a></code> linter has already discovered that the current file
is <em>not</em> imported in <code>Mathlib.lean</code>.</li>
</ul></div></div><div class="decl" id="Mathlib.Linter.linter.style.header"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/15e31b9dbf80fe0a2fcdf0eef4630bd80409b5f1/Mathlib/Tactic/Linter/Header.lean#L231-L255">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.linter.style.header"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">linter</span>.<span class="name">style</span>.<span class="name">header</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Data/Options.html#Lean.Option">Lean.Option</a> <a href="../../.././Init/Prelude.html#Bool">Bool</a></span></div></div><p>The &quot;header&quot; style linter checks that a file starts with</p><pre><code>/-
Copyright ...
Apache ...
Authors ...
-/

import statements*
module doc-string*
remaining file
</code></pre><p>It emits a warning if</p><ul>
<li>the copyright statement is malformed;</li>
<li><code>Mathlib.Tactic</code> is imported;</li>
<li>any import in <code>Lake</code> is present;</li>
<li>the first non-<code>import</code> command is not a module doc-string.</li>
</ul><p>The linter allows <code>import</code>-only files and does not require a copyright statement in <code>Mathlib.<a href="../../.././Init.html">Init</a></code>.</p></div></div><div class="decl" id="Mathlib.Linter.Style.header.broadImportsCheck"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/15e31b9dbf80fe0a2fcdf0eef4630bd80409b5f1/Mathlib/Tactic/Linter/Header.lean#L259-L281">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.Style.header.broadImportsCheck"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">Style</span>.<span class="name">header</span>.<span class="name">broadImportsCheck</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">imports</span> : <span class="fn"><a href="../../.././Init/Prelude.html#Array">Array</a> <a href="../../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">mainModule</span> : <a href="../../.././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Check the <code>Syntax</code> <code>imports</code> for broad imports:
<code>Mathlib.Tactic</code>, any import starting with <code>Lake</code>, or <code>Mathlib.Tactic.{Have,Replace}</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Mathlib.Linter.Style.header.broadImportsCheck" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Linter.Style.header.duplicateImportsCheck"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/15e31b9dbf80fe0a2fcdf0eef4630bd80409b5f1/Mathlib/Tactic/Linter/Header.lean#L283-L292">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.Style.header.duplicateImportsCheck"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">Style</span>.<span class="name">header</span>.<span class="name">duplicateImportsCheck</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">imports</span> : <span class="fn"><a href="../../.././Init/Prelude.html#Array">Array</a> <a href="../../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Check the syntax <code>imports</code> for syntactically duplicate imports.
The output is an array of <code>Syntax</code> atoms whose ranges are the import statements,
and the embedded strings are the error message of the linter.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Mathlib.Linter.Style.header.duplicateImportsCheck" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Mathlib.Linter.Style.header.headerLinter"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/15e31b9dbf80fe0a2fcdf0eef4630bd80409b5f1/Mathlib/Tactic/Linter/Header.lean#L294-L354">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Tactic/Linter/Header.html#Mathlib.Linter.Style.header.headerLinter"><span class="name">Mathlib</span>.<span class="name">Linter</span>.<span class="name">Style</span>.<span class="name">header</span>.<span class="name">headerLinter</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../.././Lean/Elab/Command.html#Lean.Elab.Command.Linter">Lean.Linter</a></div></div><p>The &quot;header&quot; style linter checks that a file starts with</p><pre><code>/-
Copyright ...
Apache ...
Authors ...
-/

import statements*
module doc-string*
remaining file
</code></pre><p>It emits a warning if</p><ul>
<li>the copyright statement is malformed;</li>
<li><code>Mathlib.Tactic</code> is imported;</li>
<li>any import in <code>Lake</code> is present;</li>
<li>the first non-<code>import</code> command is not a module doc-string.</li>
</ul><p>The linter allows <code>import</code>-only files and does not require a copyright statement in <code>Mathlib.<a href="../../.././Init.html">Init</a></code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Mathlib.Linter.Style.header.headerLinter" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src="../../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>